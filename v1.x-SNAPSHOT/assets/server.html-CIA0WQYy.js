import{_ as s,c as a,a as t,o as e}from"./app-BDMvVRGN.js";const p={};function c(o,n){return e(),a("div",null,[...n[0]||(n[0]=[t(`<h1 id="server-api" tabindex="-1"><a class="header-anchor" href="#server-api"><span>Server API</span></a></h1><h2 id="接口概述" tabindex="-1"><a class="header-anchor" href="#接口概述"><span>接口概述</span></a></h2><p>服务器 API 提供了全面的功能，用于与 Dify 平台交互，包括管理应用程序、检索和初始化应用程序及数据集的 API 密钥。所有接口都需要有效的 API 密钥进行身份验证。 使用 <code>DifyServer</code> 接口实例。</p><blockquote><p>默认检测当前环境包含 redis 则使用 redis持久化 token，若不包含 redis 则使用默认实现保存 token(重启服务会丢失)</p></blockquote><h2 id="_1-应用管理" tabindex="-1"><a class="header-anchor" href="#_1-应用管理"><span>1. 应用管理</span></a></h2><h3 id="_1-1-获取所有应用-非分页" tabindex="-1"><a class="header-anchor" href="#_1-1-获取所有应用-非分页"><span>1.1 获取所有应用 (非分页)</span></a></h3><h4 id="方法" tabindex="-1"><a class="header-anchor" href="#方法"><span>方法</span></a></h4><div class="language-java line-numbers-mode" data-highlighter="prismjs" data-ext="java"><pre><code class="language-java"><span class="line"><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">AppsResponseVO</span><span class="token punctuation">&gt;</span></span> <span class="token function">apps</span><span class="token punctuation">(</span><span class="token class-name">String</span> mode<span class="token punctuation">,</span> <span class="token class-name">String</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h4 id="请求参数" tabindex="-1"><a class="header-anchor" href="#请求参数"><span>请求参数</span></a></h4><table><thead><tr><th>参数名</th><th>类型</th><th>是否必须</th><th>描述</th></tr></thead><tbody><tr><td>mode</td><td>String</td><td>否</td><td>模式 chat\\agent-chat\\completion\\advanced-chat\\workflow</td></tr><tr><td>name</td><td>String</td><td>否</td><td>应用名称，用于过滤应用列表（可选，传入空字符串时表示不过滤）</td></tr></tbody></table><h4 id="响应参数" tabindex="-1"><a class="header-anchor" href="#响应参数"><span>响应参数</span></a></h4><p>AppsResponseVO</p><table><thead><tr><th>参数名</th><th>类型</th><th>描述</th></tr></thead><tbody><tr><td>id</td><td>String</td><td>应用ID</td></tr><tr><td>name</td><td>String</td><td>应用名称</td></tr><tr><td>maxActiveRequests</td><td>Integer</td><td>最大活跃请求数</td></tr><tr><td>description</td><td>String</td><td>应用描述</td></tr><tr><td>mode</td><td>String</td><td>应用模式</td></tr><tr><td>iconType</td><td>String</td><td>图标类型</td></tr><tr><td>icon</td><td>String</td><td>图标</td></tr><tr><td>iconBackground</td><td>String</td><td>图标背景</td></tr><tr><td>iconUrl</td><td>String</td><td>图标URL</td></tr><tr><td>modelConfig</td><td>ModelConfig</td><td>模型配置</td></tr><tr><td>workflow</td><td>Object</td><td>工作流信息</td></tr><tr><td>useIconAsAnswerIcon</td><td>Boolean</td><td>是否使用图标作为答案图标</td></tr><tr><td>createdBy</td><td>String</td><td>创建者ID</td></tr><tr><td>createdAt</td><td>Long</td><td>创建时间（时间戳）</td></tr><tr><td>updatedBy</td><td>String</td><td>更新者ID</td></tr><tr><td>updatedAt</td><td>Long</td><td>更新时间（时间戳）</td></tr><tr><td>tags</td><td><code>List&lt;String&gt;</code></td><td>应用标签</td></tr></tbody></table><p>ModelConfig</p><table><thead><tr><th>参数名</th><th>类型</th><th>描述</th></tr></thead><tbody><tr><td>model</td><td>Model</td><td>模型信息</td></tr><tr><td>prePrompt</td><td>String</td><td>预提示文本</td></tr><tr><td>createdBy</td><td>String</td><td>创建者ID</td></tr><tr><td>createdAt</td><td>Long</td><td>创建时间（时间戳）</td></tr><tr><td>updatedBy</td><td>String</td><td>更新者ID</td></tr><tr><td>updatedAt</td><td>Long</td><td>更新时间（时间戳）</td></tr></tbody></table><p>Model</p><table><thead><tr><th>参数名</th><th>类型</th><th>描述</th></tr></thead><tbody><tr><td>provider</td><td>String</td><td>模型提供商</td></tr><tr><td>name</td><td>String</td><td>模型名称</td></tr><tr><td>mode</td><td>String</td><td>模型模式</td></tr><tr><td>completionParams</td><td>CompletionParams</td><td>完成参数</td></tr></tbody></table><p>CompletionParams</p><table><thead><tr><th>参数名</th><th>类型</th><th>描述</th></tr></thead><tbody><tr><td>stop</td><td><code>List&lt;String&gt;</code></td><td>停止序列</td></tr></tbody></table><h4 id="请求示例" tabindex="-1"><a class="header-anchor" href="#请求示例"><span>请求示例</span></a></h4><div class="language-java line-numbers-mode" data-highlighter="prismjs" data-ext="java"><pre><code class="language-java"><span class="line"></span>
<span class="line"><span class="token annotation punctuation">@Resource</span></span>
<span class="line"><span class="token keyword">private</span> <span class="token class-name">DifyServer</span> difyServer<span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token annotation punctuation">@Test</span></span>
<span class="line"><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testGetApps</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token comment">// 获取所有应用</span></span>
<span class="line">    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">AppsResponseVO</span><span class="token punctuation">&gt;</span></span> apps <span class="token operator">=</span> difyServer<span class="token punctuation">.</span><span class="token function">apps</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">    <span class="token comment">// 获取带名称过滤的应用</span></span>
<span class="line">    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">AppsResponseVO</span><span class="token punctuation">&gt;</span></span> filteredApps <span class="token operator">=</span> difyServer<span class="token punctuation">.</span><span class="token function">apps</span><span class="token punctuation">(</span><span class="token string">&quot;myApp&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_1-2-分页获取应用" tabindex="-1"><a class="header-anchor" href="#_1-2-分页获取应用"><span>1.2 分页获取应用</span></a></h3><h4 id="方法-1" tabindex="-1"><a class="header-anchor" href="#方法-1"><span>方法</span></a></h4><div class="language-java line-numbers-mode" data-highlighter="prismjs" data-ext="java"><pre><code class="language-java"><span class="line"><span class="token class-name">AppsResponseResult</span> <span class="token function">apps</span><span class="token punctuation">(</span><span class="token class-name">AppsRequest</span> appsRequest<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h4 id="请求参数-1" tabindex="-1"><a class="header-anchor" href="#请求参数-1"><span>请求参数</span></a></h4><p>AppsRequest</p><table><thead><tr><th>参数名</th><th>类型</th><th>是否必须</th><th>描述</th></tr></thead><tbody><tr><td>page</td><td>Integer</td><td>否</td><td>页码（默认：1）</td></tr><tr><td>limit</td><td>Integer</td><td>否</td><td>每页数量（默认：20，范围：1-100）</td></tr><tr><td>mode</td><td>String</td><td>否</td><td>应用模式过滤：chat\\agent-chat\\completion\\advanced-chat\\workflow</td></tr><tr><td>name</td><td>String</td><td>否</td><td>应用名称过滤</td></tr><tr><td>isCreatedByMe</td><td>Boolean</td><td>否</td><td>是否为当前用户创建的应用</td></tr></tbody></table><h4 id="响应参数-1" tabindex="-1"><a class="header-anchor" href="#响应参数-1"><span>响应参数</span></a></h4><p>AppsResponseResult</p><table><thead><tr><th>参数名</th><th>类型</th><th>描述</th></tr></thead><tbody><tr><td>data</td><td><code>List&lt;AppsResponse&gt;</code></td><td>当前页数据列表</td></tr><tr><td>hasMore</td><td>Boolean</td><td>是否有更多页</td></tr><tr><td>limit</td><td>Integer</td><td>每页数量</td></tr><tr><td>page</td><td>Integer</td><td>当前页码</td></tr><tr><td>total</td><td>Integer</td><td>总数据数量</td></tr></tbody></table><p>AppsResponse 的结构与 1.1 节中定义的相同。</p><h4 id="请求示例-1" tabindex="-1"><a class="header-anchor" href="#请求示例-1"><span>请求示例</span></a></h4><div class="language-java line-numbers-mode" data-highlighter="prismjs" data-ext="java"><pre><code class="language-java"><span class="line"></span>
<span class="line"><span class="token annotation punctuation">@Resource</span></span>
<span class="line"><span class="token keyword">private</span> <span class="token class-name">DifyServer</span> difyServer<span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token annotation punctuation">@Test</span></span>
<span class="line"><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testGetAppsPaginated</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token comment">// 创建分页请求</span></span>
<span class="line">    <span class="token class-name">AppsRequest</span> request <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AppsRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    request<span class="token punctuation">.</span><span class="token function">setPage</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    request<span class="token punctuation">.</span><span class="token function">setLimit</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    request<span class="token punctuation">.</span><span class="token function">setMode</span><span class="token punctuation">(</span><span class="token string">&quot;chat&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    request<span class="token punctuation">.</span><span class="token function">setName</span><span class="token punctuation">(</span><span class="token string">&quot;myApp&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    request<span class="token punctuation">.</span><span class="token function">setIsCreatedByMe</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">    <span class="token comment">// 获取分页应用列表</span></span>
<span class="line">    <span class="token class-name">AppsResponseResult</span> result <span class="token operator">=</span> difyServer<span class="token punctuation">.</span><span class="token function">apps</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;当前页: &quot;</span> <span class="token operator">+</span> result<span class="token punctuation">.</span><span class="token function">getPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;每页数量: &quot;</span> <span class="token operator">+</span> result<span class="token punctuation">.</span><span class="token function">getLimit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;总数: &quot;</span> <span class="token operator">+</span> result<span class="token punctuation">.</span><span class="token function">getTotal</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;是否有更多: &quot;</span> <span class="token operator">+</span> result<span class="token punctuation">.</span><span class="token function">getHasMore</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;数据大小: &quot;</span> <span class="token operator">+</span> result<span class="token punctuation">.</span><span class="token function">getData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_1-3-根据id获取应用" tabindex="-1"><a class="header-anchor" href="#_1-3-根据id获取应用"><span>1.3 根据ID获取应用</span></a></h3><h4 id="方法-2" tabindex="-1"><a class="header-anchor" href="#方法-2"><span>方法</span></a></h4><div class="language-java line-numbers-mode" data-highlighter="prismjs" data-ext="java"><pre><code class="language-java"><span class="line"><span class="token class-name">AppsResponseVO</span> <span class="token function">app</span><span class="token punctuation">(</span><span class="token class-name">String</span> appId<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h4 id="请求参数-2" tabindex="-1"><a class="header-anchor" href="#请求参数-2"><span>请求参数</span></a></h4><table><thead><tr><th>参数名</th><th>类型</th><th>是否必须</th><th>描述</th></tr></thead><tbody><tr><td>appId</td><td>String</td><td>是</td><td>应用 ID</td></tr></tbody></table><h4 id="响应参数-2" tabindex="-1"><a class="header-anchor" href="#响应参数-2"><span>响应参数</span></a></h4><p>与上面定义的 AppsResponseVO 结构相同。</p><h4 id="请求示例-2" tabindex="-1"><a class="header-anchor" href="#请求示例-2"><span>请求示例</span></a></h4><div class="language-java line-numbers-mode" data-highlighter="prismjs" data-ext="java"><pre><code class="language-java"><span class="line"></span>
<span class="line"><span class="token annotation punctuation">@Resource</span></span>
<span class="line"><span class="token keyword">private</span> <span class="token class-name">DifyServer</span> difyServer<span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token annotation punctuation">@Test</span></span>
<span class="line"><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testGetApp</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token class-name">AppsResponseVO</span> app <span class="token operator">=</span> difyServer<span class="token punctuation">.</span><span class="token function">app</span><span class="token punctuation">(</span><span class="token string">&quot;app-123456789&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_1-4-获取应用api密钥" tabindex="-1"><a class="header-anchor" href="#_1-4-获取应用api密钥"><span>1.4 获取应用API密钥</span></a></h3><h4 id="方法-3" tabindex="-1"><a class="header-anchor" href="#方法-3"><span>方法</span></a></h4><div class="language-java line-numbers-mode" data-highlighter="prismjs" data-ext="java"><pre><code class="language-java"><span class="line"><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ApiKeyResponseVO</span><span class="token punctuation">&gt;</span></span> <span class="token function">getAppApiKey</span><span class="token punctuation">(</span><span class="token class-name">String</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h4 id="请求参数-3" tabindex="-1"><a class="header-anchor" href="#请求参数-3"><span>请求参数</span></a></h4><table><thead><tr><th>参数名</th><th>类型</th><th>是否必须</th><th>描述</th></tr></thead><tbody><tr><td>id</td><td>String</td><td>是</td><td>应用 ID</td></tr></tbody></table><h4 id="响应参数-3" tabindex="-1"><a class="header-anchor" href="#响应参数-3"><span>响应参数</span></a></h4><p>ApiKeyResponseVO</p><table><thead><tr><th>参数名</th><th>类型</th><th>描述</th></tr></thead><tbody><tr><td>id</td><td>String</td><td>API 密钥 ID</td></tr><tr><td>token</td><td>String</td><td>API 密钥令牌值</td></tr></tbody></table><h4 id="请求示例-3" tabindex="-1"><a class="header-anchor" href="#请求示例-3"><span>请求示例</span></a></h4><div class="language-java line-numbers-mode" data-highlighter="prismjs" data-ext="java"><pre><code class="language-java"><span class="line"></span>
<span class="line"><span class="token annotation punctuation">@Resource</span></span>
<span class="line"><span class="token keyword">private</span> <span class="token class-name">DifyServer</span> difyServer<span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token annotation punctuation">@Test</span></span>
<span class="line"><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testGetAppApiKeys</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ApiKeyResponseVO</span><span class="token punctuation">&gt;</span></span> apiKeys <span class="token operator">=</span> difyServer<span class="token punctuation">.</span><span class="token function">getAppApiKey</span><span class="token punctuation">(</span><span class="token string">&quot;app-123456789&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_1-5-初始化应用api密钥" tabindex="-1"><a class="header-anchor" href="#_1-5-初始化应用api密钥"><span>1.5 初始化应用API密钥</span></a></h3><h4 id="方法-4" tabindex="-1"><a class="header-anchor" href="#方法-4"><span>方法</span></a></h4><div class="language-java line-numbers-mode" data-highlighter="prismjs" data-ext="java"><pre><code class="language-java"><span class="line"><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ApiKeyResponseVO</span><span class="token punctuation">&gt;</span></span> <span class="token function">initAppApiKey</span><span class="token punctuation">(</span><span class="token class-name">String</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h4 id="请求参数-4" tabindex="-1"><a class="header-anchor" href="#请求参数-4"><span>请求参数</span></a></h4><table><thead><tr><th>参数名</th><th>类型</th><th>是否必须</th><th>描述</th></tr></thead><tbody><tr><td>id</td><td>String</td><td>是</td><td>应用 ID</td></tr></tbody></table><h4 id="响应参数-4" tabindex="-1"><a class="header-anchor" href="#响应参数-4"><span>响应参数</span></a></h4><p>与上面定义的 ApiKeyResponseVO 结构相同。</p><h4 id="请求示例-4" tabindex="-1"><a class="header-anchor" href="#请求示例-4"><span>请求示例</span></a></h4><div class="language-java line-numbers-mode" data-highlighter="prismjs" data-ext="java"><pre><code class="language-java"><span class="line"></span>
<span class="line"><span class="token annotation punctuation">@Resource</span></span>
<span class="line"><span class="token keyword">private</span> <span class="token class-name">DifyServer</span> difyServer<span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token annotation punctuation">@Test</span></span>
<span class="line"><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testInitAppApiKey</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ApiKeyResponseVO</span><span class="token punctuation">&gt;</span></span> apiKeys <span class="token operator">=</span> difyServer<span class="token punctuation">.</span><span class="token function">initAppApiKey</span><span class="token punctuation">(</span><span class="token string">&quot;app-123456789&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_2-知识库管理" tabindex="-1"><a class="header-anchor" href="#_2-知识库管理"><span>2. 知识库管理</span></a></h2><h3 id="_2-1-获取知识库api密钥" tabindex="-1"><a class="header-anchor" href="#_2-1-获取知识库api密钥"><span>2.1 获取知识库API密钥</span></a></h3><h4 id="方法-5" tabindex="-1"><a class="header-anchor" href="#方法-5"><span>方法</span></a></h4><div class="language-java line-numbers-mode" data-highlighter="prismjs" data-ext="java"><pre><code class="language-java"><span class="line"><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">DatasetApiKeyResponseVO</span><span class="token punctuation">&gt;</span></span> <span class="token function">getDatasetApiKey</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h4 id="响应参数-5" tabindex="-1"><a class="header-anchor" href="#响应参数-5"><span>响应参数</span></a></h4><p>DatasetApiKeyResponseVO</p><table><thead><tr><th>参数名</th><th>类型</th><th>描述</th></tr></thead><tbody><tr><td>id</td><td>String</td><td>API 密钥 ID</td></tr><tr><td>type</td><td>String</td><td>API 密钥类型</td></tr><tr><td>token</td><td>String</td><td>API 密钥令牌值</td></tr><tr><td>lastUsedAt</td><td>Long</td><td>上次使用时间（时间戳）</td></tr><tr><td>createdAt</td><td>Long</td><td>创建时间（时间戳）</td></tr></tbody></table><h4 id="请求示例-5" tabindex="-1"><a class="header-anchor" href="#请求示例-5"><span>请求示例</span></a></h4><div class="language-java line-numbers-mode" data-highlighter="prismjs" data-ext="java"><pre><code class="language-java"><span class="line"></span>
<span class="line"><span class="token annotation punctuation">@Resource</span></span>
<span class="line"><span class="token keyword">private</span> <span class="token class-name">DifyServer</span> difyServer<span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token annotation punctuation">@Test</span></span>
<span class="line"><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testGetDatasetApiKeys</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">DatasetApiKeyResponseVO</span><span class="token punctuation">&gt;</span></span> datasetApiKeys <span class="token operator">=</span> difyServer<span class="token punctuation">.</span><span class="token function">getDatasetApiKey</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-2-初始化知识库api密钥" tabindex="-1"><a class="header-anchor" href="#_2-2-初始化知识库api密钥"><span>2.2 初始化知识库API密钥</span></a></h3><h4 id="方法-6" tabindex="-1"><a class="header-anchor" href="#方法-6"><span>方法</span></a></h4><div class="language-java line-numbers-mode" data-highlighter="prismjs" data-ext="java"><pre><code class="language-java"><span class="line"><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">DatasetApiKeyResponseVO</span><span class="token punctuation">&gt;</span></span> <span class="token function">initDatasetApiKey</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h4 id="响应参数-6" tabindex="-1"><a class="header-anchor" href="#响应参数-6"><span>响应参数</span></a></h4><p>与上面定义的 DatasetApiKeyResponseVO 结构相同。</p><h4 id="请求示例-6" tabindex="-1"><a class="header-anchor" href="#请求示例-6"><span>请求示例</span></a></h4><div class="language-java line-numbers-mode" data-highlighter="prismjs" data-ext="java"><pre><code class="language-java"><span class="line"></span>
<span class="line"><span class="token annotation punctuation">@Resource</span></span>
<span class="line"><span class="token keyword">private</span> <span class="token class-name">DifyServer</span> difyServer<span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token annotation punctuation">@Test</span></span>
<span class="line"><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testInitDatasetApiKey</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">DatasetApiKeyResponseVO</span><span class="token punctuation">&gt;</span></span> datasetApiKeys <span class="token operator">=</span> difyServer<span class="token punctuation">.</span><span class="token function">initDatasetApiKey</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_3-聊天会话管理" tabindex="-1"><a class="header-anchor" href="#_3-聊天会话管理"><span>3. 聊天会话管理</span></a></h2><h3 id="_3-1-获取应用的聊天会话列表" tabindex="-1"><a class="header-anchor" href="#_3-1-获取应用的聊天会话列表"><span>3.1 获取应用的聊天会话列表</span></a></h3><h4 id="方法-7" tabindex="-1"><a class="header-anchor" href="#方法-7"><span>方法</span></a></h4><div class="language-java line-numbers-mode" data-highlighter="prismjs" data-ext="java"><pre><code class="language-java"><span class="line"><span class="token class-name">DifyPageResult</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ChatConversationResponse</span><span class="token punctuation">&gt;</span></span> <span class="token function">chatConversations</span><span class="token punctuation">(</span><span class="token class-name">ChatConversationsRequest</span> request<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h4 id="请求参数-5" tabindex="-1"><a class="header-anchor" href="#请求参数-5"><span>请求参数</span></a></h4><p>ChatConversationsRequest</p><table><thead><tr><th>参数名</th><th>类型</th><th>是否必须</th><th>描述</th></tr></thead><tbody><tr><td>appId</td><td>String</td><td>是</td><td>应用ID</td></tr><tr><td>page</td><td>Integer</td><td>否</td><td>页码（默认：1）</td></tr><tr><td>limit</td><td>Integer</td><td>否</td><td>每页数量（默认：10，范围：1-100）</td></tr><tr><td>start</td><td>String</td><td>否</td><td>开始时间，格式：yyyy-MM-dd HH:mm</td></tr><tr><td>end</td><td>String</td><td>否</td><td>结束时间，格式：yyyy-MM-dd HH:mm</td></tr><tr><td>sortBy</td><td>String</td><td>否</td><td>排序字段，例如：-created_at（按创建时间倒序）</td></tr><tr><td>annotationStatus</td><td>String</td><td>否</td><td>注释状态：all、not_annotated、annotated</td></tr></tbody></table><h4 id="响应参数-7" tabindex="-1"><a class="header-anchor" href="#响应参数-7"><span>响应参数</span></a></h4><p><code>DifyPageResult&lt;ChatConversationResponse&gt;</code></p><table><thead><tr><th>参数名</th><th>类型</th><th>描述</th></tr></thead><tbody><tr><td>data</td><td><code>List&lt;ChatConversationResponse&gt;</code></td><td>当前页数据列表</td></tr><tr><td>hasMore</td><td>Boolean</td><td>是否有更多页</td></tr><tr><td>limit</td><td>Integer</td><td>每页数量</td></tr><tr><td>page</td><td>Integer</td><td>当前页码</td></tr><tr><td>total</td><td>Integer</td><td>总数据数量</td></tr></tbody></table><p>ChatConversationResponse</p><table><thead><tr><th>参数名</th><th>类型</th><th>描述</th></tr></thead><tbody><tr><td>id</td><td>String</td><td>会话ID</td></tr><tr><td>status</td><td>String</td><td>会话状态</td></tr><tr><td>fromSource</td><td>String</td><td>来源</td></tr><tr><td>fromEndUserId</td><td>String</td><td>终端用户ID</td></tr><tr><td>fromEndUserSessionId</td><td>String</td><td>终端用户会话ID</td></tr><tr><td>fromAccountId</td><td>String</td><td>账户ID</td></tr><tr><td>fromAccountName</td><td>String</td><td>账户名称</td></tr><tr><td>name</td><td>String</td><td>会话名称</td></tr><tr><td>summary</td><td>String</td><td>会话摘要</td></tr><tr><td>readAt</td><td>Long</td><td>阅读时间戳</td></tr><tr><td>createdAt</td><td>Long</td><td>创建时间戳</td></tr><tr><td>updatedAt</td><td>Long</td><td>更新时间戳</td></tr><tr><td>annotated</td><td>Boolean</td><td>是否已标注</td></tr><tr><td>modelConfig</td><td><code>Map&lt;String, Object&gt;</code></td><td>模型配置</td></tr><tr><td>messageCount</td><td>Integer</td><td>消息数量</td></tr><tr><td>userFeedbackStats</td><td>FeedbackStats</td><td>用户反馈统计</td></tr><tr><td>adminFeedbackStats</td><td>FeedbackStats</td><td>管理员反馈统计</td></tr><tr><td>statusCount</td><td>StatusCount</td><td>状态计数</td></tr></tbody></table><p>FeedbackStats</p><table><thead><tr><th>参数名</th><th>类型</th><th>描述</th></tr></thead><tbody><tr><td>like</td><td>Integer</td><td>点赞数</td></tr><tr><td>dislike</td><td>Integer</td><td>点踩数</td></tr></tbody></table><p>StatusCount</p><table><thead><tr><th>参数名</th><th>类型</th><th>描述</th></tr></thead><tbody><tr><td>success</td><td>Integer</td><td>成功数量</td></tr><tr><td>failed</td><td>Integer</td><td>失败数量</td></tr><tr><td>partialSuccess</td><td>Integer</td><td>部分成功数量</td></tr></tbody></table><h4 id="请求示例-7" tabindex="-1"><a class="header-anchor" href="#请求示例-7"><span>请求示例</span></a></h4><div class="language-java line-numbers-mode" data-highlighter="prismjs" data-ext="java"><pre><code class="language-java"><span class="line"></span>
<span class="line"><span class="token annotation punctuation">@Resource</span></span>
<span class="line"><span class="token keyword">private</span> <span class="token class-name">DifyServer</span> difyServer<span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token annotation punctuation">@Test</span></span>
<span class="line"><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testGetChatConversations</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token comment">// 创建请求对象</span></span>
<span class="line">    <span class="token class-name">ChatConversationsRequest</span> request <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ChatConversationsRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    request<span class="token punctuation">.</span><span class="token function">setAppId</span><span class="token punctuation">(</span><span class="token string">&quot;app-123456789&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    request<span class="token punctuation">.</span><span class="token function">setPage</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    request<span class="token punctuation">.</span><span class="token function">setLimit</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    request<span class="token punctuation">.</span><span class="token function">setStart</span><span class="token punctuation">(</span><span class="token string">&quot;2025-10-23 00:00&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    request<span class="token punctuation">.</span><span class="token function">setEnd</span><span class="token punctuation">(</span><span class="token string">&quot;2025-10-30 23:59&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    request<span class="token punctuation">.</span><span class="token function">setAnnotationStatus</span><span class="token punctuation">(</span><span class="token string">&quot;all&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    request<span class="token punctuation">.</span><span class="token function">setSortBy</span><span class="token punctuation">(</span><span class="token string">&quot;-created_at&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">    <span class="token comment">// 获取聊天会话列表</span></span>
<span class="line">    <span class="token class-name">DifyPageResult</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ChatConversationResponse</span><span class="token punctuation">&gt;</span></span> result <span class="token operator">=</span> difyServer<span class="token punctuation">.</span><span class="token function">chatConversations</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;当前页: &quot;</span> <span class="token operator">+</span> result<span class="token punctuation">.</span><span class="token function">getPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;每页数量: &quot;</span> <span class="token operator">+</span> result<span class="token punctuation">.</span><span class="token function">getLimit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;总数: &quot;</span> <span class="token operator">+</span> result<span class="token punctuation">.</span><span class="token function">getTotal</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;是否有更多: &quot;</span> <span class="token operator">+</span> result<span class="token punctuation">.</span><span class="token function">getHasMore</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;数据大小: &quot;</span> <span class="token operator">+</span> result<span class="token punctuation">.</span><span class="token function">getData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">ChatConversationResponse</span> conversation <span class="token operator">:</span> result<span class="token punctuation">.</span><span class="token function">getData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;会话ID: &quot;</span> <span class="token operator">+</span> conversation<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;会话名称: &quot;</span> <span class="token operator">+</span> conversation<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;是否标注: &quot;</span> <span class="token operator">+</span> conversation<span class="token punctuation">.</span><span class="token function">isAnnotated</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,95)])])}const l=s(p,[["render",c]]),d=JSON.parse('{"path":"/guide/feature/server.html","title":"Server API","lang":"zh-cn","frontmatter":{"lang":"zh-cn","title":"Server API","description":null},"git":{"updatedTime":1761792172000,"contributors":[{"name":"yanghq","username":"yanghq","email":"1040926235@qq.com","commits":7,"url":"https://github.com/yanghq"}],"changelog":[{"hash":"0589a34f09eec51bb432b7ce2f7cd01c8d074bb4","time":1761792172000,"email":"1040926235@qq.com","author":"yanghq","message":"doc: chat-conversations api"},{"hash":"63677995e10f4e3f3b165d2b096c255a319f1acf","time":1761790968000,"email":"1040926235@qq.com","author":"yanghq","message":"feat: chat-conversations api"},{"hash":"0948f6eb734958f712b6ac3ab8e1b456487eacb8","time":1761728876000,"email":"1040926235@qq.com","author":"yanghq","message":"doc: update"},{"hash":"d069a3a5a7947ad73bcb346831888771524a93fb","time":1761728642000,"email":"1040926235@qq.com","author":"yanghq","message":"feat: apps api enhancements"},{"hash":"85c6996416acc69d6c46700179cf4322701f540c","time":1744600946000,"email":"1040926235@qq.com","author":"yanghq","message":"fix: update test"},{"hash":"c6c2edb1fab4b549428e9df63508baf42bf775d8","time":1744263215000,"email":"1040926235@qq.com","author":"yanghq","message":"doc: update custom config"},{"hash":"4286f90a3482a47347effe3b8f407afce8dfb2a5","time":1743576822000,"email":"1040926235@qq.com","author":"yanghq","message":"doc: server api"}]},"filePathRelative":"guide/feature/server.md"}');export{l as comp,d as data};
