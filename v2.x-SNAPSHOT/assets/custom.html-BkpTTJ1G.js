import{_ as s,c as a,a as t,o as p}from"./app-DOYB5FSv.js";const e={};function c(o,n){return p(),a("div",null,[...n[0]||(n[0]=[t(`<h1 id="customized-configuration" tabindex="-1"><a class="header-anchor" href="#customized-configuration"><span>Customized Configuration</span></a></h1><h2 id="spring-boot-project-customization" tabindex="-1"><a class="header-anchor" href="#spring-boot-project-customization"><span>Spring Boot Project Customization</span></a></h2><h3 id="http-client-customization" tabindex="-1"><a class="header-anchor" href="#http-client-customization"><span>HTTP Client Customization</span></a></h3><h4 id="webclient" tabindex="-1"><a class="header-anchor" href="#webclient"><span>WebClient</span></a></h4><p>Applicable to all Spring Boot versions (2.x/3.x/4.x). Supports custom <code>WebClient.Builder</code> to override the default instance.</p><div class="language-java line-numbers-mode" data-highlighter="prismjs" data-ext="java"><pre><code class="language-java"><span class="line"><span class="token annotation punctuation">@Bean</span></span>
<span class="line"><span class="token keyword">public</span> <span class="token class-name">WebClient<span class="token punctuation">.</span>Builder</span> <span class="token function">webClientBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token class-name">HttpClient</span> httpClient <span class="token operator">=</span> <span class="token class-name">HttpClient</span><span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">            <span class="token punctuation">.</span><span class="token function">protocol</span><span class="token punctuation">(</span><span class="token class-name">HttpProtocol</span><span class="token punctuation">.</span><span class="token constant">HTTP11</span><span class="token punctuation">)</span></span>
<span class="line">            <span class="token punctuation">.</span><span class="token function">option</span><span class="token punctuation">(</span><span class="token class-name">ChannelOption</span><span class="token punctuation">.</span><span class="token constant">CONNECT_TIMEOUT_MILLIS</span><span class="token punctuation">,</span> <span class="token number">30000</span><span class="token punctuation">)</span></span>
<span class="line">            <span class="token punctuation">.</span><span class="token function">responseTimeout</span><span class="token punctuation">(</span><span class="token class-name">Duration</span><span class="token punctuation">.</span><span class="token function">ofSeconds</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">return</span> <span class="token class-name">WebClient</span><span class="token punctuation">.</span><span class="token function">builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">            <span class="token punctuation">.</span><span class="token function">defaultHeader</span><span class="token punctuation">(</span><span class="token class-name">HttpHeaders</span><span class="token punctuation">.</span><span class="token constant">CONTENT_TYPE</span><span class="token punctuation">,</span> <span class="token class-name">MediaType</span><span class="token punctuation">.</span><span class="token constant">APPLICATION_JSON_VALUE</span><span class="token punctuation">)</span></span>
<span class="line">            <span class="token punctuation">.</span><span class="token function">clientConnector</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ReactorClientHttpConnector</span><span class="token punctuation">(</span>httpClient<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="restclient" tabindex="-1"><a class="header-anchor" href="#restclient"><span>RestClient</span></a></h4><p>Applicable to Spring Boot 3.2+ and Spring Boot 4.x. Supports custom <code>RestClient.Builder</code> to override the default instance.</p><div class="language-java line-numbers-mode" data-highlighter="prismjs" data-ext="java"><pre><code class="language-java"><span class="line"><span class="token annotation punctuation">@Bean</span></span>
<span class="line"><span class="token keyword">public</span> <span class="token class-name">RestClient<span class="token punctuation">.</span>Builder</span> <span class="token function">restClientBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">return</span> <span class="token class-name">RestClient</span><span class="token punctuation">.</span><span class="token function">builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">            <span class="token punctuation">.</span><span class="token function">defaultHeader</span><span class="token punctuation">(</span><span class="token class-name">HttpHeaders</span><span class="token punctuation">.</span><span class="token constant">CONTENT_TYPE</span><span class="token punctuation">,</span> <span class="token class-name">MediaType</span><span class="token punctuation">.</span><span class="token constant">APPLICATION_JSON_VALUE</span><span class="token punctuation">)</span></span>
<span class="line">            <span class="token punctuation">.</span><span class="token function">requestFactory</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">JdkClientHttpRequestFactory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p><strong>Note</strong>: Spring Boot 2.x does not support RestClient, the framework will automatically use WebClient.</p></blockquote><h3 id="json-codec-customization" tabindex="-1"><a class="header-anchor" href="#json-codec-customization"><span>JSON Codec Customization</span></a></h3><h4 id="using-custom-jsonmapper-jackson" tabindex="-1"><a class="header-anchor" href="#using-custom-jsonmapper-jackson"><span>Using Custom JsonMapper (Jackson)</span></a></h4><div class="language-java line-numbers-mode" data-highlighter="prismjs" data-ext="java"><pre><code class="language-java"><span class="line"><span class="token annotation punctuation">@Bean</span></span>
<span class="line"><span class="token keyword">public</span> <span class="token class-name">JsonMapper</span> <span class="token function">jsonMapper</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">return</span> <span class="token class-name">JacksonJsonMapper</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="complete-customization-example" tabindex="-1"><a class="header-anchor" href="#complete-customization-example"><span>Complete Customization Example</span></a></h3><div class="language-java line-numbers-mode" data-highlighter="prismjs" data-ext="java"><pre><code class="language-java"><span class="line"><span class="token annotation punctuation">@Configuration</span></span>
<span class="line"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DifyCustomConfiguration</span> <span class="token punctuation">{</span></span>
<span class="line"></span>
<span class="line">    <span class="token annotation punctuation">@Bean</span></span>
<span class="line">    <span class="token keyword">public</span> <span class="token class-name">WebClient<span class="token punctuation">.</span>Builder</span> <span class="token function">webClientBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token class-name">HttpClient</span> httpClient <span class="token operator">=</span> <span class="token class-name">HttpClient</span><span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">                <span class="token punctuation">.</span><span class="token function">protocol</span><span class="token punctuation">(</span><span class="token class-name">HttpProtocol</span><span class="token punctuation">.</span><span class="token constant">HTTP11</span><span class="token punctuation">)</span></span>
<span class="line">                <span class="token punctuation">.</span><span class="token function">option</span><span class="token punctuation">(</span><span class="token class-name">ChannelOption</span><span class="token punctuation">.</span><span class="token constant">CONNECT_TIMEOUT_MILLIS</span><span class="token punctuation">,</span> <span class="token number">30000</span><span class="token punctuation">)</span></span>
<span class="line">                <span class="token punctuation">.</span><span class="token function">responseTimeout</span><span class="token punctuation">(</span><span class="token class-name">Duration</span><span class="token punctuation">.</span><span class="token function">ofSeconds</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">        <span class="token keyword">return</span> <span class="token class-name">WebClient</span><span class="token punctuation">.</span><span class="token function">builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">                <span class="token punctuation">.</span><span class="token function">defaultHeader</span><span class="token punctuation">(</span><span class="token class-name">HttpHeaders</span><span class="token punctuation">.</span><span class="token constant">CONTENT_TYPE</span><span class="token punctuation">,</span> <span class="token class-name">MediaType</span><span class="token punctuation">.</span><span class="token constant">APPLICATION_JSON_VALUE</span><span class="token punctuation">)</span></span>
<span class="line">                <span class="token punctuation">.</span><span class="token function">clientConnector</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ReactorClientHttpConnector</span><span class="token punctuation">(</span>httpClient<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">    <span class="token annotation punctuation">@Bean</span></span>
<span class="line">    <span class="token annotation punctuation">@ConditionalOnClass</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;org.springframework.web.client.RestClient&quot;</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">public</span> <span class="token class-name">RestClient<span class="token punctuation">.</span>Builder</span> <span class="token function">restClientBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">return</span> <span class="token class-name">RestClient</span><span class="token punctuation">.</span><span class="token function">builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">                <span class="token punctuation">.</span><span class="token function">defaultHeader</span><span class="token punctuation">(</span><span class="token class-name">HttpHeaders</span><span class="token punctuation">.</span><span class="token constant">CONTENT_TYPE</span><span class="token punctuation">,</span> <span class="token class-name">MediaType</span><span class="token punctuation">.</span><span class="token constant">APPLICATION_JSON_VALUE</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">    <span class="token annotation punctuation">@Bean</span></span>
<span class="line">    <span class="token keyword">public</span> <span class="token class-name">JsonMapper</span> <span class="token function">jsonMapper</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">return</span> <span class="token class-name">JacksonJsonMapper</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="pure-java-project-customization" tabindex="-1"><a class="header-anchor" href="#pure-java-project-customization"><span>Pure Java Project Customization</span></a></h2><p>For pure Java projects, you can customize the configuration through the <code>HttpClientFactory</code> fluent API.</p><h3 id="adding-default-headers" tabindex="-1"><a class="header-anchor" href="#adding-default-headers"><span>Adding Default Headers</span></a></h3><div class="language-java line-numbers-mode" data-highlighter="prismjs" data-ext="java"><pre><code class="language-java"><span class="line"><span class="token keyword">import</span> <span class="token import"><span class="token namespace">io<span class="token punctuation">.</span>github<span class="token punctuation">.</span>guoshiqiufeng<span class="token punctuation">.</span>dify<span class="token punctuation">.</span>client<span class="token punctuation">.</span>integration<span class="token punctuation">.</span>okhttp<span class="token punctuation">.</span>http<span class="token punctuation">.</span></span><span class="token class-name">JavaHttpClientFactory</span></span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">import</span> <span class="token import"><span class="token namespace">io<span class="token punctuation">.</span>github<span class="token punctuation">.</span>guoshiqiufeng<span class="token punctuation">.</span>dify<span class="token punctuation">.</span>client<span class="token punctuation">.</span>codec<span class="token punctuation">.</span>jackson<span class="token punctuation">.</span></span><span class="token class-name">JacksonJsonMapper</span></span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">import</span> <span class="token import"><span class="token namespace">io<span class="token punctuation">.</span>github<span class="token punctuation">.</span>guoshiqiufeng<span class="token punctuation">.</span>dify<span class="token punctuation">.</span>client<span class="token punctuation">.</span>core<span class="token punctuation">.</span>http<span class="token punctuation">.</span></span><span class="token class-name">HttpClientFactory</span></span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// Create base factory</span></span>
<span class="line"><span class="token class-name">JavaHttpClientFactory</span> baseFactory <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">JavaHttpClientFactory</span><span class="token punctuation">(</span><span class="token class-name">JacksonJsonMapper</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// Add default headers</span></span>
<span class="line"><span class="token class-name">HttpClientFactory</span> customFactory <span class="token operator">=</span> baseFactory</span>
<span class="line">        <span class="token punctuation">.</span><span class="token function">defaultHeader</span><span class="token punctuation">(</span><span class="token string">&quot;X-Custom-Header&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;custom-value&quot;</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">.</span><span class="token function">defaultHeader</span><span class="token punctuation">(</span><span class="token string">&quot;User-Agent&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;MyApp/1.0&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// Use custom factory to create client</span></span>
<span class="line"><span class="token class-name">DifyChatClient</span> client <span class="token operator">=</span> <span class="token class-name">DifyChatBuilder</span><span class="token punctuation">.</span><span class="token function">builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">.</span><span class="token function">baseUrl</span><span class="token punctuation">(</span><span class="token string">&quot;https://api.dify.ai&quot;</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">.</span><span class="token function">clientConfig</span><span class="token punctuation">(</span>clientConfig<span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">.</span><span class="token function">httpClientFactory</span><span class="token punctuation">(</span>customFactory<span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="adding-custom-interceptors" tabindex="-1"><a class="header-anchor" href="#adding-custom-interceptors"><span>Adding Custom Interceptors</span></a></h3><div class="language-java line-numbers-mode" data-highlighter="prismjs" data-ext="java"><pre><code class="language-java"><span class="line"><span class="token keyword">import</span> <span class="token import"><span class="token namespace">okhttp3<span class="token punctuation">.</span></span><span class="token class-name">Interceptor</span></span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">import</span> <span class="token import"><span class="token namespace">okhttp3<span class="token punctuation">.</span></span><span class="token class-name">Response</span></span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// Create custom interceptor</span></span>
<span class="line"><span class="token class-name">Interceptor</span> loggingInterceptor <span class="token operator">=</span> chain <span class="token operator">-&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token class-name"><span class="token namespace">okhttp3<span class="token punctuation">.</span></span>Request</span> request <span class="token operator">=</span> chain<span class="token punctuation">.</span><span class="token function">request</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Request: &quot;</span> <span class="token operator">+</span> request<span class="token punctuation">.</span><span class="token function">url</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token class-name">Response</span> response <span class="token operator">=</span> chain<span class="token punctuation">.</span><span class="token function">proceed</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Response: &quot;</span> <span class="token operator">+</span> response<span class="token punctuation">.</span><span class="token function">code</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword">return</span> response<span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// Create factory and add interceptor</span></span>
<span class="line"><span class="token class-name">HttpClientFactory</span> customFactory <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">JavaHttpClientFactory</span><span class="token punctuation">(</span><span class="token class-name">JacksonJsonMapper</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">.</span><span class="token function">interceptor</span><span class="token punctuation">(</span>loggingInterceptor<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// Use custom factory to create client</span></span>
<span class="line"><span class="token class-name">DifyChatClient</span> client <span class="token operator">=</span> <span class="token class-name">DifyChatBuilder</span><span class="token punctuation">.</span><span class="token function">builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">.</span><span class="token function">baseUrl</span><span class="token punctuation">(</span><span class="token string">&quot;https://api.dify.ai&quot;</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">.</span><span class="token function">clientConfig</span><span class="token punctuation">(</span>clientConfig<span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">.</span><span class="token function">httpClientFactory</span><span class="token punctuation">(</span>customFactory<span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="configuring-timeouts" tabindex="-1"><a class="header-anchor" href="#configuring-timeouts"><span>Configuring Timeouts</span></a></h3><p>Timeouts are configured through <code>ClientConfig</code>:</p><div class="language-java line-numbers-mode" data-highlighter="prismjs" data-ext="java"><pre><code class="language-java"><span class="line"><span class="token keyword">import</span> <span class="token import"><span class="token namespace">io<span class="token punctuation">.</span>github<span class="token punctuation">.</span>guoshiqiufeng<span class="token punctuation">.</span>dify<span class="token punctuation">.</span>core<span class="token punctuation">.</span>config<span class="token punctuation">.</span></span><span class="token class-name">DifyProperties</span></span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// Create client configuration</span></span>
<span class="line"><span class="token class-name">DifyProperties<span class="token punctuation">.</span>ClientConfig</span> clientConfig <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DifyProperties<span class="token punctuation">.</span>ClientConfig</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">clientConfig<span class="token punctuation">.</span><span class="token function">setConnectTimeout</span><span class="token punctuation">(</span><span class="token number">60</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Connection timeout 60 seconds</span></span>
<span class="line">clientConfig<span class="token punctuation">.</span><span class="token function">setReadTimeout</span><span class="token punctuation">(</span><span class="token number">60</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// Read timeout 60 seconds</span></span>
<span class="line">clientConfig<span class="token punctuation">.</span><span class="token function">setWriteTimeout</span><span class="token punctuation">(</span><span class="token number">60</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// Write timeout 60 seconds</span></span>
<span class="line">clientConfig<span class="token punctuation">.</span><span class="token function">setLogging</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token comment">// Enable logging</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// Use configuration to create client</span></span>
<span class="line"><span class="token class-name">DifyChatClient</span> client <span class="token operator">=</span> <span class="token class-name">DifyChatBuilder</span><span class="token punctuation">.</span><span class="token function">builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">.</span><span class="token function">baseUrl</span><span class="token punctuation">(</span><span class="token string">&quot;https://api.dify.ai&quot;</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">.</span><span class="token function">clientConfig</span><span class="token punctuation">(</span>clientConfig<span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">.</span><span class="token function">httpClientFactory</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">JavaHttpClientFactory</span><span class="token punctuation">(</span><span class="token class-name">JacksonJsonMapper</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="performance-optimization-configuration" tabindex="-1"><a class="header-anchor" href="#performance-optimization-configuration"><span>Performance Optimization Configuration</span></a></h3><h4 id="connection-pool-configuration" tabindex="-1"><a class="header-anchor" href="#connection-pool-configuration"><span>Connection Pool Configuration</span></a></h4><p>For high-concurrency scenarios, you can configure OkHttp connection pool parameters to improve performance:</p><div class="language-java line-numbers-mode" data-highlighter="prismjs" data-ext="java"><pre><code class="language-java"><span class="line"><span class="token keyword">import</span> <span class="token import"><span class="token namespace">io<span class="token punctuation">.</span>github<span class="token punctuation">.</span>guoshiqiufeng<span class="token punctuation">.</span>dify<span class="token punctuation">.</span>core<span class="token punctuation">.</span>config<span class="token punctuation">.</span></span><span class="token class-name">DifyProperties</span></span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token class-name">DifyProperties<span class="token punctuation">.</span>ClientConfig</span> clientConfig <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DifyProperties<span class="token punctuation">.</span>ClientConfig</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// Connection pool configuration</span></span>
<span class="line">clientConfig<span class="token punctuation">.</span><span class="token function">setMaxIdleConnections</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token comment">// Max idle connections, default 5 (minimum 1)</span></span>
<span class="line">clientConfig<span class="token punctuation">.</span><span class="token function">setKeepAliveSeconds</span><span class="token punctuation">(</span><span class="token number">300</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token comment">// Keep-alive duration (seconds), default 300 (minimum 1)</span></span>
<span class="line">clientConfig<span class="token punctuation">.</span><span class="token function">setMaxRequests</span><span class="token punctuation">(</span><span class="token number">128</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment">// Max concurrent requests, default 64 (minimum 1)</span></span>
<span class="line">clientConfig<span class="token punctuation">.</span><span class="token function">setMaxRequestsPerHost</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token comment">// Max concurrent requests per host, default 5 (minimum 1)</span></span>
<span class="line">clientConfig<span class="token punctuation">.</span><span class="token function">setCallTimeout</span><span class="token punctuation">(</span><span class="token number">60</span><span class="token punctuation">)</span><span class="token punctuation">;</span>             <span class="token comment">// Call timeout (seconds), 0 means no limit</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// SSE timeout configuration</span></span>
<span class="line">clientConfig<span class="token punctuation">.</span><span class="token function">setSseReadTimeout</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token comment">// SSE read timeout (seconds)</span></span>
<span class="line">                                             <span class="token comment">// null (default) = use readTimeout</span></span>
<span class="line">                                             <span class="token comment">// 0 = disable timeout (for long streaming conversations)</span></span>
<span class="line">                                             <span class="token comment">// &gt;0 = use specified timeout</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// Create client</span></span>
<span class="line"><span class="token class-name">DifyChatClient</span> client <span class="token operator">=</span> <span class="token class-name">DifyChatBuilder</span><span class="token punctuation">.</span><span class="token function">builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">.</span><span class="token function">baseUrl</span><span class="token punctuation">(</span><span class="token string">&quot;https://api.dify.ai&quot;</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">.</span><span class="token function">clientConfig</span><span class="token punctuation">(</span>clientConfig<span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">.</span><span class="token function">httpClientFactory</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">JavaHttpClientFactory</span><span class="token punctuation">(</span><span class="token class-name">JacksonJsonMapper</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>Configuration Details</strong>:</p><ul><li><code>maxIdleConnections</code>: Maximum number of idle connections in the pool, increase for better connection reuse</li><li><code>keepAliveSeconds</code>: Keep-alive duration for idle connections, connections exceeding this time will be closed</li><li><code>maxRequests</code>: Global maximum concurrent requests, limits overall concurrency</li><li><code>maxRequestsPerHost</code>: Maximum concurrent requests per host, prevents overwhelming a single server</li><li><code>callTimeout</code>: Total call timeout (including connect, read, write), 0 means no limit</li></ul><p><strong>Recommended Settings</strong>:</p><ul><li>Low concurrency (&lt; 10 QPS): Use default values</li><li>Medium concurrency (10-100 QPS): <code>maxIdleConnections=10</code>, <code>maxRequests=128</code>, <code>maxRequestsPerHost=10</code></li><li>High concurrency (&gt; 100 QPS): <code>maxIdleConnections=20</code>, <code>maxRequests=256</code>, <code>maxRequestsPerHost=20</code></li></ul><h4 id="sse-streaming-optimization" tabindex="-1"><a class="header-anchor" href="#sse-streaming-optimization"><span>SSE Streaming Optimization</span></a></h4><p>For SSE (Server-Sent Events) long-connection scenarios, you can configure specific timeout strategies:</p><div class="language-java line-numbers-mode" data-highlighter="prismjs" data-ext="java"><pre><code class="language-java"><span class="line"><span class="token class-name">DifyProperties<span class="token punctuation">.</span>ClientConfig</span> clientConfig <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DifyProperties<span class="token punctuation">.</span>ClientConfig</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// SSE optimization configuration</span></span>
<span class="line">clientConfig<span class="token punctuation">.</span><span class="token function">setSseReadTimeout</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// Disable SSE read timeout, default 0 (disabled)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// Create client</span></span>
<span class="line"><span class="token class-name">DifyChatClient</span> client <span class="token operator">=</span> <span class="token class-name">DifyChatBuilder</span><span class="token punctuation">.</span><span class="token function">builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">.</span><span class="token function">baseUrl</span><span class="token punctuation">(</span><span class="token string">&quot;https://api.dify.ai&quot;</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">.</span><span class="token function">clientConfig</span><span class="token punctuation">(</span>clientConfig<span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">.</span><span class="token function">httpClientFactory</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">JavaHttpClientFactory</span><span class="token punctuation">(</span><span class="token class-name">JacksonJsonMapper</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>Configuration Details</strong>:</p><ul><li><code>sseReadTimeout</code>: Read timeout for SSE streaming responses (seconds) <ul><li><code>null</code> (default): Use the <code>readTimeout</code> value</li><li><code>0</code>: Completely disable timeout for long-running streaming conversations</li><li><code>&gt;0</code>: Use the specified timeout in seconds</li></ul></li></ul><h4 id="logging-optimization-configuration" tabindex="-1"><a class="header-anchor" href="#logging-optimization-configuration"><span>Logging Optimization Configuration</span></a></h4><p>For large response scenarios, you can configure logging limits to reduce memory usage:</p><div class="language-java line-numbers-mode" data-highlighter="prismjs" data-ext="java"><pre><code class="language-java"><span class="line"><span class="token class-name">DifyProperties<span class="token punctuation">.</span>ClientConfig</span> clientConfig <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DifyProperties<span class="token punctuation">.</span>ClientConfig</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// Logging optimization configuration</span></span>
<span class="line">clientConfig<span class="token punctuation">.</span><span class="token function">setLogging</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>              <span class="token comment">// Enable logging</span></span>
<span class="line">clientConfig<span class="token punctuation">.</span><span class="token function">setLoggingMaskEnabled</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// Enable log masking, default true</span></span>
<span class="line">clientConfig<span class="token punctuation">.</span><span class="token function">setLogBodyMaxBytes</span><span class="token punctuation">(</span><span class="token number">8192</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token comment">// Max body bytes in logs, default 4096 (4KB)</span></span>
<span class="line">clientConfig<span class="token punctuation">.</span><span class="token function">setLogBinaryBody</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token comment">// Whether to log binary responses, default false</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// Create client</span></span>
<span class="line"><span class="token class-name">DifyChatClient</span> client <span class="token operator">=</span> <span class="token class-name">DifyChatBuilder</span><span class="token punctuation">.</span><span class="token function">builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">.</span><span class="token function">baseUrl</span><span class="token punctuation">(</span><span class="token string">&quot;https://api.dify.ai&quot;</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">.</span><span class="token function">clientConfig</span><span class="token punctuation">(</span>clientConfig<span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">.</span><span class="token function">httpClientFactory</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">JavaHttpClientFactory</span><span class="token punctuation">(</span><span class="token class-name">JacksonJsonMapper</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>Configuration Details</strong>:</p><ul><li><code>loggingMaskEnabled</code>: Enable log masking, default true. When enabled, automatically masks sensitive parameters (api_key, token, password, secret, authorization, access_token, refresh_token, etc.)</li><li><code>logBodyMaxBytes</code>: Maximum bytes of response body to log, truncated if exceeded. Set to 0 for no limit</li><li><code>logBinaryBody</code>: Whether to log binary responses (e.g., images, files). When enabled, logs binary content size and Content-Type. Recommended to set false to save memory</li></ul><p><strong>Recommended Settings</strong>:</p><ul><li>Development: <code>logBodyMaxBytes=0</code> (no limit), convenient for debugging</li><li>Testing: <code>logBodyMaxBytes=8192</code> (8KB), balances readability and performance</li><li>Production: <code>logBodyMaxBytes=4096</code> (4KB) or smaller, reduces memory usage</li></ul><h4 id="complete-performance-optimization-example" tabindex="-1"><a class="header-anchor" href="#complete-performance-optimization-example"><span>Complete Performance Optimization Example</span></a></h4><div class="language-java line-numbers-mode" data-highlighter="prismjs" data-ext="java"><pre><code class="language-java"><span class="line"><span class="token keyword">import</span> <span class="token import"><span class="token namespace">io<span class="token punctuation">.</span>github<span class="token punctuation">.</span>guoshiqiufeng<span class="token punctuation">.</span>dify<span class="token punctuation">.</span>core<span class="token punctuation">.</span>config<span class="token punctuation">.</span></span><span class="token class-name">DifyProperties</span></span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">import</span> <span class="token import"><span class="token namespace">io<span class="token punctuation">.</span>github<span class="token punctuation">.</span>guoshiqiufeng<span class="token punctuation">.</span>dify<span class="token punctuation">.</span>client<span class="token punctuation">.</span>integration<span class="token punctuation">.</span>okhttp<span class="token punctuation">.</span>http<span class="token punctuation">.</span></span><span class="token class-name">JavaHttpClientFactory</span></span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">import</span> <span class="token import"><span class="token namespace">io<span class="token punctuation">.</span>github<span class="token punctuation">.</span>guoshiqiufeng<span class="token punctuation">.</span>dify<span class="token punctuation">.</span>client<span class="token punctuation">.</span>codec<span class="token punctuation">.</span>jackson<span class="token punctuation">.</span></span><span class="token class-name">JacksonJsonMapper</span></span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// Create high-performance configuration</span></span>
<span class="line"><span class="token class-name">DifyProperties<span class="token punctuation">.</span>ClientConfig</span> clientConfig <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DifyProperties<span class="token punctuation">.</span>ClientConfig</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// Basic timeout configuration</span></span>
<span class="line">clientConfig<span class="token punctuation">.</span><span class="token function">setConnectTimeout</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">clientConfig<span class="token punctuation">.</span><span class="token function">setReadTimeout</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">clientConfig<span class="token punctuation">.</span><span class="token function">setWriteTimeout</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// Connection pool optimization (high concurrency scenario)</span></span>
<span class="line">clientConfig<span class="token punctuation">.</span><span class="token function">setMaxIdleConnections</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">clientConfig<span class="token punctuation">.</span><span class="token function">setKeepAliveSeconds</span><span class="token punctuation">(</span><span class="token number">300</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">clientConfig<span class="token punctuation">.</span><span class="token function">setMaxRequests</span><span class="token punctuation">(</span><span class="token number">256</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">clientConfig<span class="token punctuation">.</span><span class="token function">setMaxRequestsPerHost</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">clientConfig<span class="token punctuation">.</span><span class="token function">setCallTimeout</span><span class="token punctuation">(</span><span class="token number">60</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// SSE optimization</span></span>
<span class="line">clientConfig<span class="token punctuation">.</span><span class="token function">setSseReadTimeout</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// Logging optimization</span></span>
<span class="line">clientConfig<span class="token punctuation">.</span><span class="token function">setLogging</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">clientConfig<span class="token punctuation">.</span><span class="token function">setLoggingMaskEnabled</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">clientConfig<span class="token punctuation">.</span><span class="token function">setLogBodyMaxBytes</span><span class="token punctuation">(</span><span class="token number">4096</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">clientConfig<span class="token punctuation">.</span><span class="token function">setLogBinaryBody</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// Create client</span></span>
<span class="line"><span class="token class-name">DifyChatClient</span> client <span class="token operator">=</span> <span class="token class-name">DifyChatBuilder</span><span class="token punctuation">.</span><span class="token function">builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">.</span><span class="token function">baseUrl</span><span class="token punctuation">(</span><span class="token string">&quot;https://api.dify.ai&quot;</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">.</span><span class="token function">clientConfig</span><span class="token punctuation">(</span>clientConfig<span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">.</span><span class="token function">httpClientFactory</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">JavaHttpClientFactory</span><span class="token punctuation">(</span><span class="token class-name">JacksonJsonMapper</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="custom-json-codec" tabindex="-1"><a class="header-anchor" href="#custom-json-codec"><span>Custom JSON Codec</span></a></h3><h4 id="using-jackson-codec-default" tabindex="-1"><a class="header-anchor" href="#using-jackson-codec-default"><span>Using Jackson Codec (Default)</span></a></h4><div class="language-java line-numbers-mode" data-highlighter="prismjs" data-ext="java"><pre><code class="language-java"><span class="line"><span class="token keyword">import</span> <span class="token import"><span class="token namespace">io<span class="token punctuation">.</span>github<span class="token punctuation">.</span>guoshiqiufeng<span class="token punctuation">.</span>dify<span class="token punctuation">.</span>client<span class="token punctuation">.</span>codec<span class="token punctuation">.</span>jackson<span class="token punctuation">.</span></span><span class="token class-name">JacksonJsonMapper</span></span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// Use default Jackson mapper</span></span>
<span class="line"><span class="token class-name">JavaHttpClientFactory</span> httpClientFactory <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">JavaHttpClientFactory</span><span class="token punctuation">(</span><span class="token class-name">JacksonJsonMapper</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="using-gson-codec" tabindex="-1"><a class="header-anchor" href="#using-gson-codec"><span>Using Gson Codec</span></a></h4><div class="language-java line-numbers-mode" data-highlighter="prismjs" data-ext="java"><pre><code class="language-java"><span class="line"><span class="token keyword">import</span> <span class="token import"><span class="token namespace">io<span class="token punctuation">.</span>github<span class="token punctuation">.</span>guoshiqiufeng<span class="token punctuation">.</span>dify<span class="token punctuation">.</span>client<span class="token punctuation">.</span>codec<span class="token punctuation">.</span>gson<span class="token punctuation">.</span></span><span class="token class-name">GsonJsonMapper</span></span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// Use Gson mapper</span></span>
<span class="line"><span class="token class-name">JavaHttpClientFactory</span> httpClientFactory <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">JavaHttpClientFactory</span><span class="token punctuation">(</span><span class="token class-name">GsonJsonMapper</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="using-jackson-3-codec-spring-boot-4-x" tabindex="-1"><a class="header-anchor" href="#using-jackson-3-codec-spring-boot-4-x"><span>Using Jackson 3 Codec (Spring Boot 4.x)</span></a></h4><div class="language-java line-numbers-mode" data-highlighter="prismjs" data-ext="java"><pre><code class="language-java"><span class="line"><span class="token keyword">import</span> <span class="token import"><span class="token namespace">io<span class="token punctuation">.</span>github<span class="token punctuation">.</span>guoshiqiufeng<span class="token punctuation">.</span>dify<span class="token punctuation">.</span>client<span class="token punctuation">.</span>codec<span class="token punctuation">.</span>jackson3<span class="token punctuation">.</span></span><span class="token class-name">Jackson3JsonMapper</span></span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// Use Jackson 3 mapper</span></span>
<span class="line"><span class="token class-name">JavaHttpClientFactory</span> httpClientFactory <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">JavaHttpClientFactory</span><span class="token punctuation">(</span><span class="token class-name">Jackson3JsonMapper</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p><strong>Note</strong>: All JSON mappers use the singleton pattern. Use <code>getInstance()</code> method to get instances. For custom configuration, you can access the underlying instance via <code>getObjectMapper()</code> or <code>getGson()</code>.</p></blockquote><h3 id="complete-customization-example-1" tabindex="-1"><a class="header-anchor" href="#complete-customization-example-1"><span>Complete Customization Example</span></a></h3><div class="language-java line-numbers-mode" data-highlighter="prismjs" data-ext="java"><pre><code class="language-java"><span class="line"><span class="token keyword">import</span> <span class="token import"><span class="token namespace">io<span class="token punctuation">.</span>github<span class="token punctuation">.</span>guoshiqiufeng<span class="token punctuation">.</span>dify<span class="token punctuation">.</span>client<span class="token punctuation">.</span>integration<span class="token punctuation">.</span>okhttp<span class="token punctuation">.</span>http<span class="token punctuation">.</span></span><span class="token class-name">JavaHttpClientFactory</span></span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">import</span> <span class="token import"><span class="token namespace">io<span class="token punctuation">.</span>github<span class="token punctuation">.</span>guoshiqiufeng<span class="token punctuation">.</span>dify<span class="token punctuation">.</span>client<span class="token punctuation">.</span>codec<span class="token punctuation">.</span>jackson<span class="token punctuation">.</span></span><span class="token class-name">JacksonJsonMapper</span></span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">import</span> <span class="token import"><span class="token namespace">io<span class="token punctuation">.</span>github<span class="token punctuation">.</span>guoshiqiufeng<span class="token punctuation">.</span>dify<span class="token punctuation">.</span>core<span class="token punctuation">.</span>config<span class="token punctuation">.</span></span><span class="token class-name">DifyProperties</span></span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">import</span> <span class="token import"><span class="token namespace">io<span class="token punctuation">.</span>github<span class="token punctuation">.</span>guoshiqiufeng<span class="token punctuation">.</span>dify<span class="token punctuation">.</span>client<span class="token punctuation">.</span>core<span class="token punctuation">.</span>http<span class="token punctuation">.</span></span><span class="token class-name">HttpClientFactory</span></span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">import</span> <span class="token import"><span class="token namespace">okhttp3<span class="token punctuation">.</span></span><span class="token class-name">Interceptor</span></span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// 1. Use Jackson mapper</span></span>
<span class="line"><span class="token class-name">JacksonJsonMapper</span> jsonMapper <span class="token operator">=</span> <span class="token class-name">JacksonJsonMapper</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// 2. Create custom interceptor</span></span>
<span class="line"><span class="token class-name">Interceptor</span> authInterceptor <span class="token operator">=</span> chain <span class="token operator">-&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token class-name"><span class="token namespace">okhttp3<span class="token punctuation">.</span></span>Request</span> request <span class="token operator">=</span> chain<span class="token punctuation">.</span><span class="token function">request</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">newBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">            <span class="token punctuation">.</span><span class="token function">addHeader</span><span class="token punctuation">(</span><span class="token string">&quot;Authorization&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Bearer token&quot;</span><span class="token punctuation">)</span></span>
<span class="line">            <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword">return</span> chain<span class="token punctuation">.</span><span class="token function">proceed</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// 3. Create HTTP client factory and configure</span></span>
<span class="line"><span class="token class-name">HttpClientFactory</span> httpClientFactory <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">JavaHttpClientFactory</span><span class="token punctuation">(</span>jsonMapper<span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">.</span><span class="token function">defaultHeader</span><span class="token punctuation">(</span><span class="token string">&quot;X-App-Version&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;1.0.0&quot;</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">.</span><span class="token function">interceptor</span><span class="token punctuation">(</span>authInterceptor<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// 4. Create client configuration</span></span>
<span class="line"><span class="token class-name">DifyProperties<span class="token punctuation">.</span>ClientConfig</span> clientConfig <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DifyProperties<span class="token punctuation">.</span>ClientConfig</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">clientConfig<span class="token punctuation">.</span><span class="token function">setConnectTimeout</span><span class="token punctuation">(</span><span class="token number">60</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">clientConfig<span class="token punctuation">.</span><span class="token function">setReadTimeout</span><span class="token punctuation">(</span><span class="token number">60</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">clientConfig<span class="token punctuation">.</span><span class="token function">setWriteTimeout</span><span class="token punctuation">(</span><span class="token number">60</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">clientConfig<span class="token punctuation">.</span><span class="token function">setLogging</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">clientConfig<span class="token punctuation">.</span><span class="token function">setSkipNull</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// 5. Use custom configuration to create client</span></span>
<span class="line"><span class="token class-name">DifyChatClient</span> client <span class="token operator">=</span> <span class="token class-name">DifyChatBuilder</span><span class="token punctuation">.</span><span class="token function">builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">.</span><span class="token function">baseUrl</span><span class="token punctuation">(</span><span class="token string">&quot;https://api.dify.ai&quot;</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">.</span><span class="token function">clientConfig</span><span class="token punctuation">(</span>clientConfig<span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">.</span><span class="token function">httpClientFactory</span><span class="token punctuation">(</span>httpClientFactory<span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="version-notes" tabindex="-1"><a class="header-anchor" href="#version-notes"><span>Version Notes</span></a></h2><ul><li><strong>Spring Boot 2.x</strong>: WebClient only</li><li><strong>Spring Boot 3.0-3.1</strong>: WebClient only</li><li><strong>Spring Boot 3.2+</strong>: WebClient and RestClient supported</li><li><strong>Spring Boot 4.x</strong>: WebClient and RestClient supported</li><li><strong>Pure Java Projects</strong>: OkHttp client</li></ul>`,58)])])}const l=s(e,[["render",c]]),u=JSON.parse('{"path":"/en/config/custom.html","title":"Customized Configuration","lang":"en-US","frontmatter":{"lang":"en-US","title":"Customized Configuration","description":null},"git":{"updatedTime":1770392265000,"contributors":[{"name":"yanghq","username":"yanghq","email":"1040926235@qq.com","commits":14,"url":"https://github.com/yanghq"}],"changelog":[{"hash":"30f277f07a3114dc493104b428aa4aa78e419696","time":1770392265000,"email":"1040926235@qq.com","author":"yanghq","message":"feat(http): enhance HTTP client with connection pooling and advanced logging"},{"hash":"269883ced299799884a1f10d947091afe4a1fad7","time":1770281464000,"email":"1040926235@qq.com","author":"yanghq","message":"feat(perf): add performance optimization configurations and comprehensive test coverage"},{"hash":"e88fb90732e0d74bc548983b2435bb36e55b6117","time":1769153107000,"email":"1040926235@qq.com","author":"yanghq","message":"doc: update custom config","tag":"v2.0.0"},{"hash":"96b10ab4fc8a5e0859b506c77b2e6764dadced4d","time":1768203260000,"email":"1040926235@qq.com","author":"yanghq","message":"2.0.0-SNAPSHOT: doc 2.0.0-SNAPSHOT: changelog"},{"hash":"ec8bbd85b1aeb127c97f04bea8c8bf81c805158a","time":1744879838000,"email":"1040926235@qq.com","author":"yanghq","message":"doc: update config"},{"hash":"31acfeffa099739163efba8f145d358b14f5adaf","time":1744341714000,"email":"1040926235@qq.com","author":"yanghq","message":"doc: child chunks"},{"hash":"c6c2edb1fab4b549428e9df63508baf42bf775d8","time":1744263215000,"email":"1040926235@qq.com","author":"yanghq","message":"doc: update custom config"},{"hash":"803ef646a0fb6e16d75378fbc0e02bcca323daf5","time":1742794763000,"email":"1040926235@qq.com","author":"yanghq","message":"feat: WebClient Specifies version as Http1.1, Add the spring-boot-starter-reactor-netty dependency"},{"hash":"a3edef7d7b8e7837f4fcb5207573907ab2f01517","time":1742462004000,"email":"1040926235@qq.com","author":"yanghq","message":"feat: Move DifyProperties email\\\\password under DifyProperties server"},{"hash":"b5ac0e69faaf27535567fe23e99bddf27eb4c217","time":1742461373000,"email":"1040926235@qq.com","author":"yanghq","message":"feat: rename DifyServerProperties DifyProperties"},{"hash":"6530be7f860135081c184d78405a48d04f65ea9c","time":1742434053000,"email":"1040926235@qq.com","author":"yanghq","message":"doc: Extract difyWorkflowWebClient"},{"hash":"b4d6b27e9b443d94c86b682b8715996ecf11575c","time":1742433555000,"email":"1040926235@qq.com","author":"yanghq","message":"doc: Extract difyChatWebClient"},{"hash":"eab675fa5615f7cc4053688dbe42b9266653caf7","time":1742433355000,"email":"1040926235@qq.com","author":"yanghq","message":"reformat code"},{"hash":"6cbbf686fa7595403827e007bfd7bca72931597e","time":1742377434000,"email":"1040926235@qq.com","author":"yanghq","message":"doc: update dataset doc"}]},"filePathRelative":"en/config/custom.md"}');export{l as comp,u as data};
