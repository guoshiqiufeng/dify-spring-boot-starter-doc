import{_ as p,c as i,b as s,d as a,e as l,w as t,a as c,r as o,o as u}from"./app-BskTWXfy.js";const r={};function d(m,n){const e=o("RouteLink");return u(),i("div",null,[n[9]||(n[9]=s("h1",{id:"配置",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#配置"},[s("span",null,"配置")])],-1)),n[10]||(n[10]=s("p",null,[s("a",{href:"https://github.com/guoshiqiufeng/dify-spring-boot-starter",target:"_blank",rel:"noopener noreferrer"},"dify-spring-boot-starter"),a(" 的配置非常简单，只需要一些基础配置即可开始使用！")],-1)),s("blockquote",null,[s("p",null,[n[1]||(n[1]=a("请确保您已经安装了 dify-spring-boot-starter，如果您尚未安装，请查看 ",-1)),l(e,{to:"/guide/install.html"},{default:t(()=>[...n[0]||(n[0]=[a("安装",-1)])]),_:1}),n[2]||(n[2]=a("。",-1))])]),n[11]||(n[11]=c(`<h2 id="spring-boot-自动配置" tabindex="-1"><a class="header-anchor" href="#spring-boot-自动配置"><span>Spring Boot 自动配置</span></a></h2><p>对于 Spring Boot 项目，框架会自动配置所有必要的组件，您只需要在配置文件中提供连接参数即可。</p><h3 id="基础配置" tabindex="-1"><a class="header-anchor" href="#基础配置"><span>基础配置</span></a></h3><div class="language-yaml line-numbers-mode" data-highlighter="prismjs" data-ext="yml"><pre><code class="language-yaml"><span class="line"><span class="token key atrule">dify</span><span class="token punctuation">:</span></span>
<span class="line">  <span class="token key atrule">url</span><span class="token punctuation">:</span> http<span class="token punctuation">:</span>//192.168.1.10 <span class="token comment"># Dify 服务地址</span></span>
<span class="line">  <span class="token key atrule">server</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token key atrule">email</span><span class="token punctuation">:</span> admin@admin.com <span class="token comment"># Dify 服务邮箱（调用 Server API 时需要）</span></span>
<span class="line">    <span class="token key atrule">password</span><span class="token punctuation">:</span> admin123456 <span class="token comment"># Dify 服务密码（调用 Server API 时需要）</span></span>
<span class="line">    <span class="token key atrule">password-encryption</span><span class="token punctuation">:</span> <span class="token boolean important">true</span> <span class="token comment"># 密码加密开关，默认 true</span></span>
<span class="line">                               <span class="token comment"># Dify 1.11.2+ 需要开启（或使用 Base64 密文）</span></span>
<span class="line">                               <span class="token comment"># Dify 1.11.2 以下版本设置为 false</span></span>
<span class="line">  <span class="token key atrule">dataset</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token key atrule">api-key</span><span class="token punctuation">:</span> dataset<span class="token punctuation">-</span>aaabbbcccdddeeefffggghhh <span class="token comment"># 知识库 API Key（调用 Dataset API 时需要）</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="客户端配置" tabindex="-1"><a class="header-anchor" href="#客户端配置"><span>客户端配置</span></a></h3><div class="language-yaml line-numbers-mode" data-highlighter="prismjs" data-ext="yml"><pre><code class="language-yaml"><span class="line"><span class="token key atrule">dify</span><span class="token punctuation">:</span></span>
<span class="line">  <span class="token key atrule">client-config</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token key atrule">skip-null</span><span class="token punctuation">:</span> <span class="token boolean important">true</span> <span class="token comment"># 是否跳过 null 字段，默认 true</span></span>
<span class="line">    <span class="token key atrule">logging</span><span class="token punctuation">:</span> <span class="token boolean important">true</span> <span class="token comment"># 是否打印请求日志，默认 true</span></span>
<span class="line">    <span class="token key atrule">connect-timeout</span><span class="token punctuation">:</span> <span class="token number">30</span> <span class="token comment"># 连接超时时间（秒），默认 30</span></span>
<span class="line">    <span class="token key atrule">read-timeout</span><span class="token punctuation">:</span> <span class="token number">30</span> <span class="token comment"># 读取超时时间（秒），默认 30</span></span>
<span class="line">    <span class="token key atrule">write-timeout</span><span class="token punctuation">:</span> <span class="token number">30</span> <span class="token comment"># 写入超时时间（秒），默认 30</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="性能优化配置" tabindex="-1"><a class="header-anchor" href="#性能优化配置"><span>性能优化配置</span></a></h3><p>针对高并发场景和大规模应用，可以配置以下性能优化参数：</p><div class="language-yaml line-numbers-mode" data-highlighter="prismjs" data-ext="yml"><pre><code class="language-yaml"><span class="line"><span class="token key atrule">dify</span><span class="token punctuation">:</span></span>
<span class="line">  <span class="token key atrule">client-config</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token comment"># 基础超时配置</span></span>
<span class="line">    <span class="token key atrule">connect-timeout</span><span class="token punctuation">:</span> <span class="token number">30</span></span>
<span class="line">    <span class="token key atrule">read-timeout</span><span class="token punctuation">:</span> <span class="token number">30</span></span>
<span class="line">    <span class="token key atrule">write-timeout</span><span class="token punctuation">:</span> <span class="token number">30</span></span>
<span class="line"></span>
<span class="line">    <span class="token comment"># 连接池优化（提升吞吐量 20-30%）</span></span>
<span class="line">    <span class="token key atrule">max-idle-connections</span><span class="token punctuation">:</span> <span class="token number">10</span>      <span class="token comment"># 最大空闲连接数，默认 5</span></span>
<span class="line">    <span class="token key atrule">keep-alive-seconds</span><span class="token punctuation">:</span> <span class="token number">300</span>       <span class="token comment"># 连接保活时间（秒），默认 300</span></span>
<span class="line">    <span class="token key atrule">max-requests</span><span class="token punctuation">:</span> <span class="token number">128</span>             <span class="token comment"># 最大并发请求数，默认 64</span></span>
<span class="line">    <span class="token key atrule">max-requests-per-host</span><span class="token punctuation">:</span> <span class="token number">10</span>     <span class="token comment"># 每个主机最大并发请求数，默认 5</span></span>
<span class="line">    <span class="token key atrule">call-timeout</span><span class="token punctuation">:</span> <span class="token number">60</span>              <span class="token comment"># 调用超时时间（秒），0 表示不设置</span></span>
<span class="line"></span>
<span class="line">    <span class="token comment"># SSE 流式优化（减少断流 90%+）</span></span>
<span class="line">    <span class="token key atrule">sse-read-timeout</span><span class="token punctuation">:</span> <span class="token number">0</span>           <span class="token comment"># SSE 读取超时（秒），0 表示禁用超时</span></span>
<span class="line"></span>
<span class="line">    <span class="token comment"># 日志优化（降低内存使用 30-50%）</span></span>
<span class="line">    <span class="token key atrule">logging</span><span class="token punctuation">:</span> <span class="token boolean important">true</span></span>
<span class="line">    <span class="token key atrule">logging-mask-enabled</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>    <span class="token comment"># 启用日志脱敏，默认 true</span></span>
<span class="line">    <span class="token key atrule">log-body-max-bytes</span><span class="token punctuation">:</span> <span class="token number">4096</span>      <span class="token comment"># 日志 body 最大字节数，默认 4096（4KB）</span></span>
<span class="line">    <span class="token key atrule">log-binary-body</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>        <span class="token comment"># 是否记录二进制响应，默认 false</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>配置说明</strong>：</p><p><strong>连接池配置</strong>：</p><ul><li><code>max-idle-connections</code>: 连接池中保持的最大空闲连接数，增加可提高连接复用率</li><li><code>keep-alive-seconds</code>: 空闲连接的保活时间，超过此时间的连接将被关闭</li><li><code>max-requests</code>: 全局最大并发请求数，限制整体并发量</li><li><code>max-requests-per-host</code>: 单个主机的最大并发请求数，避免对单个服务器压力过大</li><li><code>call-timeout</code>: 完整调用的超时时间（包括连接、读取、写入），0 表示不限制</li></ul><p><strong>SSE 优化</strong>：</p><ul><li><code>sse-read-timeout</code>: SSE 流式响应的读取超时时间（秒），设置为 0 表示禁用超时，适用于长时间运行的流式对话</li></ul><p><strong>日志优化</strong>：</p><ul><li><code>log-body-max-bytes</code>: 日志中记录的响应 body 最大字节数，超过则截断。设置为 0 表示不限制</li><li><code>log-binary-body</code>: 是否记录二进制响应（如图片、文件），建议设置为 false 以节省内存</li></ul><p><strong>推荐配置</strong>：</p><ul><li><strong>低并发场景</strong>（&lt; 10 QPS）：使用默认值</li><li><strong>中等并发场景</strong>（10-100 QPS）：<div class="language-yaml line-numbers-mode" data-highlighter="prismjs" data-ext="yml"><pre><code class="language-yaml"><span class="line"><span class="token key atrule">max-idle-connections</span><span class="token punctuation">:</span> <span class="token number">10</span></span>
<span class="line"><span class="token key atrule">max-requests</span><span class="token punctuation">:</span> <span class="token number">128</span></span>
<span class="line"><span class="token key atrule">max-requests-per-host</span><span class="token punctuation">:</span> <span class="token number">10</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><strong>高并发场景</strong>（&gt; 100 QPS）：<div class="language-yaml line-numbers-mode" data-highlighter="prismjs" data-ext="yml"><pre><code class="language-yaml"><span class="line"><span class="token key atrule">max-idle-connections</span><span class="token punctuation">:</span> <span class="token number">20</span></span>
<span class="line"><span class="token key atrule">max-requests</span><span class="token punctuation">:</span> <span class="token number">256</span></span>
<span class="line"><span class="token key atrule">max-requests-per-host</span><span class="token punctuation">:</span> <span class="token number">20</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><h3 id="状态监控配置" tabindex="-1"><a class="header-anchor" href="#状态监控配置"><span>状态监控配置</span></a></h3><div class="language-yaml line-numbers-mode" data-highlighter="prismjs" data-ext="yml"><pre><code class="language-yaml"><span class="line"><span class="token key atrule">dify</span><span class="token punctuation">:</span></span>
<span class="line">  <span class="token key atrule">status</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token key atrule">health-indicator-enabled</span><span class="token punctuation">:</span> <span class="token boolean important">false</span> <span class="token comment"># 是否启用健康指示器，默认 false</span></span>
<span class="line">    <span class="token key atrule">health-indicator-init-by-server</span><span class="token punctuation">:</span> <span class="token boolean important">true</span> <span class="token comment"># 是否通过 Server 初始化，默认 true</span></span>
<span class="line">    <span class="token key atrule">api-key</span><span class="token punctuation">:</span> your<span class="token punctuation">-</span>api<span class="token punctuation">-</span>key <span class="token comment"># 通用 API Key（可选）</span></span>
<span class="line">    <span class="token key atrule">dataset-api-key</span><span class="token punctuation">:</span> dataset<span class="token punctuation">-</span>key <span class="token comment"># Dataset API Key（可选）</span></span>
<span class="line">    <span class="token key atrule">chat-api-key</span><span class="token punctuation">:</span> <span class="token comment"># Chat API Key 列表（可选）</span></span>
<span class="line">      <span class="token punctuation">-</span> chat<span class="token punctuation">-</span>key<span class="token punctuation">-</span><span class="token number">1</span></span>
<span class="line">      <span class="token punctuation">-</span> chat<span class="token punctuation">-</span>key<span class="token punctuation">-</span><span class="token number">2</span></span>
<span class="line">    <span class="token key atrule">workflow-api-key</span><span class="token punctuation">:</span> <span class="token comment"># Workflow API Key 列表（可选）</span></span>
<span class="line">      <span class="token punctuation">-</span> workflow<span class="token punctuation">-</span>key<span class="token punctuation">-</span><span class="token number">1</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="完整配置示例" tabindex="-1"><a class="header-anchor" href="#完整配置示例"><span>完整配置示例</span></a></h3><div class="language-yaml line-numbers-mode" data-highlighter="prismjs" data-ext="yml"><pre><code class="language-yaml"><span class="line"><span class="token key atrule">dify</span><span class="token punctuation">:</span></span>
<span class="line">  <span class="token key atrule">url</span><span class="token punctuation">:</span> http<span class="token punctuation">:</span>//192.168.1.10</span>
<span class="line">  <span class="token key atrule">server</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token key atrule">email</span><span class="token punctuation">:</span> admin@admin.com</span>
<span class="line">    <span class="token key atrule">password</span><span class="token punctuation">:</span> admin123456</span>
<span class="line">    <span class="token key atrule">password-encryption</span><span class="token punctuation">:</span> <span class="token boolean important">true</span></span>
<span class="line">  <span class="token key atrule">dataset</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token key atrule">api-key</span><span class="token punctuation">:</span> dataset<span class="token punctuation">-</span>aaabbbcccdddeeefffggghhh</span>
<span class="line">  <span class="token key atrule">client-config</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token key atrule">skip-null</span><span class="token punctuation">:</span> <span class="token boolean important">true</span></span>
<span class="line">    <span class="token key atrule">logging</span><span class="token punctuation">:</span> <span class="token boolean important">true</span></span>
<span class="line">    <span class="token key atrule">connect-timeout</span><span class="token punctuation">:</span> <span class="token number">30</span></span>
<span class="line">    <span class="token key atrule">read-timeout</span><span class="token punctuation">:</span> <span class="token number">30</span></span>
<span class="line">    <span class="token key atrule">write-timeout</span><span class="token punctuation">:</span> <span class="token number">30</span></span>
<span class="line">  <span class="token key atrule">status</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token key atrule">health-indicator-enabled</span><span class="token punctuation">:</span> <span class="token boolean important">true</span></span>
<span class="line">    <span class="token key atrule">health-indicator-init-by-server</span><span class="token punctuation">:</span> <span class="token boolean important">true</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,22)),s("p",null,[n[4]||(n[4]=a("详细配置参数说明请查看 ",-1)),l(e,{to:"/config/introduction.html"},{default:t(()=>[...n[3]||(n[3]=[a("配置参数",-1)])]),_:1}),n[5]||(n[5]=a("。",-1))]),n[12]||(n[12]=s("h2",{id:"纯-java-项目配置",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#纯-java-项目配置"},[s("span",null,"纯 Java 项目配置")])],-1)),s("p",null,[n[7]||(n[7]=a("对于纯 Java 项目（不使用 Spring Boot），您需要手动构建客户端。请查看 ",-1)),l(e,{to:"/guide/builder.html"},{default:t(()=>[...n[6]||(n[6]=[a("构建器模式",-1)])]),_:1}),n[8]||(n[8]=a(" 了解详细信息。",-1))])])}const v=p(r,[["render",d]]),b=JSON.parse('{"path":"/guide/config.html","title":"配置","lang":"zh-cn","frontmatter":{"lang":"zh-cn","title":"配置","description":null},"git":{"updatedTime":1770281464000,"contributors":[{"name":"yanghq","username":"yanghq","email":"1040926235@qq.com","commits":7,"url":"https://github.com/yanghq"}],"changelog":[{"hash":"269883ced299799884a1f10d947091afe4a1fad7","time":1770281464000,"email":"1040926235@qq.com","author":"yanghq","message":"feat(perf): add performance optimization configurations and comprehensive test coverage"},{"hash":"aff79c75b05ed3f03eccfc3faaea184377369c0c","time":1768651081000,"email":"1040926235@qq.com","author":"yanghq","message":"test: add comprehensive test coverage for SpringUtil docs: improve documentation clarity and consistency docs: update copyright year to 2024-2026 perf: improve thread safety and fix memory leak refactor: improve exception handling for unknown HTTP errors feat: improve logging perf: optimize HashMap capacity and add lazy initialization chore: optimize project structure and enhance error handling"},{"hash":"96b10ab4fc8a5e0859b506c77b2e6764dadced4d","time":1768203260000,"email":"1040926235@qq.com","author":"yanghq","message":"2.0.0-SNAPSHOT: doc 2.0.0-SNAPSHOT: changelog"},{"hash":"831ea19853fe88a99630712d9b2c74932459b3b3","time":1766983823000,"email":"1040926235@qq.com","author":"yanghq","message":"fix: server login for new password encryption feature"},{"hash":"a3edef7d7b8e7837f4fcb5207573907ab2f01517","time":1742462004000,"email":"1040926235@qq.com","author":"yanghq","message":"feat: Move DifyProperties email\\\\password under DifyProperties server"},{"hash":"6cbbf686fa7595403827e007bfd7bca72931597e","time":1742377434000,"email":"1040926235@qq.com","author":"yanghq","message":"doc: update dataset doc"},{"hash":"9b5fe204d7e3d722968c2210d61725329e71879b","time":1741498622000,"email":"1040926235@qq.com","author":"yanghq","message":"init"}]},"filePathRelative":"guide/config.md"}');export{v as comp,b as data};
